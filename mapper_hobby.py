#!/usr/bin/env python

import sys
import json
import re

black_list = ['whowouldwin', 'wouldyourather', 'scenesfromahat', 'AskOuija', 'cosplay', 'cosplaygirls', 'DnD', 'DnDGreentext', 'DnDBehindTheScreen', 'dndnext', 'dungeonsanddragons', 'criticalrole', 'DMAcademy', 'magicTCG', 'modernmagic', 'zombies', 'cyberpunk', 'fantasy', 'scifi', 'starwars', 'startrek', 'asksciencefiction', 'prequelmemes', 'empiredidnothingwrong', 'SequelMemes', 'sciencefiction', 'DarkMatter', 'DefianceTV', 'DoctorWho', 'KilljoysTV', 'OtherSpaceTV', 'RedDwarf', 'StarWarsRebels', 'ThunderbirdsAreGo', 'Andromeda', 'Babylon5', 'Caprica', 'Farscape', 'Firefly', 'Futurama', 'LostInSpace', 'Lexx', 'Space1999', 'SpaceAboveandBeyond', 'SGA', 'DeepSpaceNine', 'StarTrekEnterprise', 'TNG', 'TheAnimatedSeries', 'TOS', 'Voyager', 'TheCloneWars', 'TheThunderbirds', 'LV426', 'BSG', 'Defiance', 'Dune', 'GalaxyQuest', 'DontPanic', 'Spaceballs', 'Stargate', 'Treknobabble', 'StarWars', 'themartian', 'Thunderbirds', 'printSF', 'ScienceFiction', 'SciFi', 'AskScienceFiction', 'movies', 'Television', 'SpaceGameJunkie', 'EliteDangerous', 'StarCitizen', 'AttackWing', 'startrekgames', 'sto', 'gaming', 'Games', 'outside', 'truegaming', 'gamernews', 'gamephysics', 'webgames', 'IndieGaming', 'patientgamers', 'AndroidGaming', 'randomactsofgaming', 'speedrun', 'gamemusic', 'emulation', 'MMORPG', 'gamecollecting', 'hitboxporn', 'gamingcirclejerk', 'gamersriseup', 'gamingdetails', 'gaming4gamers', 'retrogaming', 'GameDeals', 'steamdeals', 'PS4Deals', 'freegamesonsteam', 'shouldibuythisgame', 'nintendoswitchdeals', 'freegamefindings', 'xboxone', 'oculus', 'vive', 'paradoxplaza', 'pcmasterrace', 'pcgaming', 'gamingpc', 'steam', 'linux_gaming', 'nintendo', '3DS', 'wiiu', 'nintendoswitch', '3dshacks', 'amiibo', 'sony', 'PS3', 'playstation', 'vita', 'PSVR', 'playstationplus', 'PS4', 'PS4Deals', 'DotA2', 'starcraft', 'smashbros', 'dayz', 'civ', 'KerbalSpaceProgram', 'masseffect', 'clashofclans', 'starbound', 'heroesofthestorm', 'terraria', 'dragonage', 'citiesskylines', 'smite', 'bindingofisaac', 'eve', 'starcitizen', 'animalcrossing', 'metalgearsolid', 'elitedangerous', 'bloodborne', 'monsterhunter', 'warframe', 'undertale', 'thedivision', 'stardewvalley', 'nomansskythegame', 'totalwar', 'pathofexile', 'ClashRoyale', 'crusaderkings', 'dwarffortress', 'eu4', 'thesims', 'assassinscreed', 'playrust', 'forhonor', 'stellaris', 'kingdomhearts', 'blackdesertonline', 'factorio', 'Warhammer', 'splatoon', 'rimworld', 'Xcom', 'streetfighter', 'paydaytheheist', 'MonsterHunterWorld', 'Seaofthieves', 'cyberpunkgame', 'warhammer40k', 'paladins', 'osugame', 'spidermanps4', 'persona5', 'horizion', 'reddeadredemption', 'mountandblade', 'deadbydaylight', 'farcry', 'hoi4', 'warthunder', 'grandorder', 'divinityoriginalsin', 'escapefromtarkov', 'theexpanse', 'darkestdungeon', 'forza', 'godofwar', 'ark', 'bioshock', 'edh', 'summonerswar', 'duellinks', 'arma', 'pathfinderrpg', 'footballmanagergames', 'kingdomcome', 'subnautica', 'thelastofus', 'doom', 'jrpg', 'borderlands', 'borderlands2', 'DarkSouls', 'DarkSouls2', 'DarkSouls3', 'diablo', 'diablo3', 'elderscrollsonline', 'ElderScrolls', 'teslore', 'Skyrim', 'skyrimmods', 'fallout', 'fo4', 'fo76', 'fireemblem', 'FireEmblemHeroes', 'FortniteBR', 'Fortnite', 'FortniteBattleRoyale', 'Fortnitecompetitive', 'FortniteLeaks', 'GrandTheftAutoV', 'gtav', 'gtaonline', 'hearthstone', 'CompetitiveHS', 'customhearthstone', 'minecraft', 'feedthebeast', 'overwatch', 'competitiveoverwatch', 'overwatchuniversity', 'Overwatch_Memes', 'Overwatch_Porn', 'PUBATTLEGROUNDS', 'PUBG', 'pubgxboxone', 'pubgmobile', 'rocketleague', 'rocketleagueexchange', 'witcher', 'gwent', 'tf2', 'starwarsbattlefront', 'rainbow6', 'titanfall', 'shittyrainbow6', 'battlefield_4', 'battlefield', 'battlefield_one', 'blackops3', 'CODZombies', 'callofduty', 'WWII', 'blackops4', 'codcompetitive', 'GlobalOffensive', 'globaloffensivetrade (private)', 'csgo', 'halo', 'haloonline', 'fifa', 'nba2k', 'DestinyTheGame', 'fireteams', 'destiny2', 'leagueoflegends', 'summonerschool', 'LoLeventVODs', 'wow', 'guildwars2', 'swtor', 'ffxiv', 'FinalFantasy', 'ffxv', 'Pokemon', 'friendsafari', 'pokemontrades', 'pokemongo', 'TheSilphRoad', 'Runescape', '2007scape', 'zelda', 'breath_of_the_wild']

patterns = ["i'm fond of ", "i'm keen on ", 'i like ', 'i enjoy ' , 'i love ', 'i play ', 'i go in for ', 'i am fond of ', 'my hobby is ', 'i take joy in ', 'i am keen on ', 'i adore ', 'i appreciate ', 'i am a fan of ', "i'm a fan of ", 'i am fascinated by ', "i'm fascinated by ", 'i am interested in ', "i'm interested in ", 'i fancy ', 'i am mad about ', "i'm mad about " , "i practise "]
patterns_with_len = [(pat, len(pat)) for pat in patterns]
hobbies_big = ['sketching', 'felting', 'wingsuit flying', 'actionfigure', 'bridge', 'candlemaking', 'rollerderby', 'playing musical instruments', 'cheerleading', 'seashell collecting', 'cake decorating', 'bmx', 'archery', 'freshwater aquariums', 'making model cars', 'violin', 'jewelrymaking', 'diecasttoy', 'ghost hunting', 'amateur astronomy', 'auto racing', 'horseback riding', 'computer programming', 'esports', 'books', 'artcollecting', 'marchingband', 'exhibition drill', 'hula hooping', 'the game of go', 'shootingsport', 'knife making', 'eating', 'flower collecting and pressing', 'scubadiving', 'skimboarding', 'audiophile', 'debate', 'kitchen chemistry', 'seashellcollecting', 'treasure hunting', 'volleyball', 'blogging', 'collecting artwork', 'racing pigeons', 'golf', 'inventing', 'geocaching', 'learning a foreign language', 'sand art', 'associationfootball', 'waterpolo', 'piano', 'tennispolo', 'football', 'equestrianism', 'sculling', 'letterboxing', 'musical instruments', 'kartracing', 'mineralcollecting', 'r/c planes', 'watersports', 'foreign language learning', 'flowercollectingandpressing', 'cricket', 'yoga', 'pottery', 'astrology', 'listening to music', 'gamingtabletopgamesandroleplayinggames', 'genealogy', 'motor sports', 'baking', 'goldprospecting', 'tennis', 'amateurastronomy', 'motorsports', 'roller skating', 'fantasy sports', 'shoes', 'meditation', 'gardening', 'amateur radio', 'cryptography', 'woodworking', 'scrapbooking', 'travel', 'hunting', 'climbing', 'elementcollecting', 'flying disc', 'watchingmovies', 'rafting', 'wine making', 'art collecting', 'running', 'hot air ballooning', 'poi', 'face painting', 'hiking/backpacking', 'phillumeny', 'slot car racing', 'skateboarding', 'videogamedeveloping', 'train spotting', 'bus spotting', 'wood carving', 'video gaming', 'dprinting', 'reading', 'flyingdisc', 'learning an instrument', 'sport stacking', 'autoaudiophilia', 'tai chi', 'embroidery', 'coincollecting', 'jet engines', 'lacemaking', 'entertaining', 'nordicskating', 'couponing', 'golfing', 'movie memorabilia collecting', 'dancing', 'photography', 'watching sporting events', 'educational courses', 'juggling', 'rollerskating', 'triathlon', 'taxidermy', 'record collecting', 'sculpting', 'skeet shooting', 'button collecting', 'disc golf', 'field hockey', 'metal detecting', 'pigeon racing', 'rockets', 'bookbinding', 'juggling & poi', 'marbles', 'crocheting', 'association football', 'knife throwing', 'airbrushing', 'whittling', 'comic book collecting', 'collecting records', 'guitar', 'fitness', 'recordcollecting', 'shooting sport', 'handball', 'aircraftspotting', 'shortwavelistening', 'kite boarding', 'playing team sports', 'slingshots', 'train collecting', 'tv watching', 'shopping', 'jewelry making', 'ultimatefrisbee', 'rock climbing', 'radiocontrolledcarracing', 'figure skating', 'sportstacking', 'jump roping', 'gongoozling', 'hooping', 'exhibitiondrill', 'beatboxing', 'horsebackriding', 'discgolf', 'creative writing', 'flying', 'leather crafting', 'collecting hats', 'flagfootball', 'windsurfing', 'collecting antiques', 'magnet fishing', 'snorkeling', 'foreignlanguagelearning', 'herpkeeping', 'rockclimbing', 'kart racing', 'vintagecars', 'scuba diving', 'mahjong', 'digitalarts', 'robot combat', 'watchingtelevision', 'dumpster diving', 'cooking', 'compose music', 'roadbiking', 'aircraft spotting', 'motorcycles', 'kitesurfing', 'drawing', 'saltwater aquariums', 'woodcarving', 'gaming (tabletop games and role-playing games)', 'nail art', 'soccer', 'squash', 'learning', 'horse riding', 'bicycle polo', 'papermache', 'puzzles', 'birding', 'water polo', 'satellite watching', 'australian rules football', 'deltiologypostcardcollecting', 'speedcubing', 'flower arranging', 'seaglasscollecting', 'ice hockey', 'stand-up comedy', 'model engineering', 'computer activities', 'amateurradio', 'movie and movie memorabilia collecting', 'legobuilding', 'sand castles', 'yoyoing', 'parachuting', 'aquarium (freshwater & saltwater)', 'jewellery making', 'sea glass collecting', 'fieldhockey', 'electronics', 'creativewriting', 'beachvolleyball', 'arts', 'bowling', 'machining', 'weather watcher', 'digital photography', 'dog sport', 'coffee roasting', 'model rockets', 'airsports', 'sports shooting', 'canyoning', 'slacklining', 'magic', 'mountain climbing', 'shogi', 'cross-stitch', 'martialarts', 'animation', 'videogamecollecting', 'modelengineering', 'airsoft', 'tea tasting', 'theatre', 'reading fiction', 'fashion', 'longboarding', 'antiquing', 'bonsai tree', 'cartooning', 'tourskating', 'quilting', 'zumba', 'road biking', 'video editing', 'brazilianjiujitsu', 'rappelling', 'herping', 'videophilia', 'boating', 'action figure', 'ice skating', 'swimming', 'drama', 'animal fancy', 'rugbyleaguefootball', 'rowing', 'people watching', 'whale watching', 'americanfootball', 'antiquities', 'birdwatching', 'fishkeeping', 'blacksmithing', 'sudoku', 'owning an antique car', 'jogging', 'colorguard', 'go kart racing', 'australianrulesfootball', 'singing in choir', 'yo-yoing', 'mineral collecting', 'needlepoint', 'vehiclerestoration', 'railtransportmodelling', 'stoneskipping', 'backgammon', 'martial arts', 'dowsing', 'graffiti', 'tour skating', 'fishing', 'falconry', 'inlineskating', 'traveling', 'writing songs', 'videogaming', 'tabletennis', 'sky diving', 'curling', 'dolls', 'knifemaking', 'writing', 'fossilhunting', 'racquetball', 'table tennis', 'cosplaying', 'videoediting', 'beach volleyball', 'flying airplane', 'puppetry', 'flower collecting', 'coffeeroasting', 'origami', 'kite flying', 'writing stories', 'crossword puzzles', 'knapping', 'snowboarding', 'crossstitch', 'skiing', 'freestylefootball', 'metal working', 'four wheeling', 'exercise (aerobics, weights)', 'gaming', 'icehockey', 'planking', 'speedskating', 'topiary', 'american football', 'modelaircraft', 'ziplining', 'modelbuilding', 'polo', 'rugby', 'textiles', 'crafts', 'stamp collecting', 'storytelling', 'rugby league football', 'kombucha brewing', 'watching movies', 'lacrosse', 'busspotting', 'computerprogramming', 'tablefootball', 'stone skipping', 'rock balancing', 'cycling', 'collecting', 'acting', 'table football', 'scouting', 'do it yourself', 'air sports', 'radio-controlled car racing', 'astronomy', 'board games', 'doityourself', 'model building', 'diy', 'dogsport', 'dance', 'modeling ships', 'cabaret', 'singing', 'metalworking', 'kayaking', 'toy collecting', 'taekwondo', 'robotcombat', 'candle making', 'boxing', 'urban exploration', 'baton twirling', 'deltiology', 'hydroponics', 'knifethrowing', 'batontwirling', 'driving', 'walking', 'sailing', 'soap making', 'surfing', 'lapidary', 'perfume', 'stampcollecting', 'board sports', 'learning to pilot a plane', 'vehicle restoration', 'flowerarranging', 'knitting', 'knifecollecting', 'chess', 'boardtabletopgames', 'stone collecting', 'car boot', 'knife collecting', 'billiards', 'knotting', 'soapmaking', 'worldbuilding', 'crosswordpuzzles', 'trainspotting', 'body building', 'fossil hunting', 'element collecting', 'gunsmithing', 'magnetfishing', 'animalfancy', 'shortwave listening', 'video game developing', 'reading non-fiction', 'cardcollecting', 'die-cast toy', 'book collecting', 'hiking', 'ultimate frisbee', 'matchstick modeling', 'iceskating', 'tennis polo', 'world record breaking', 'rail transport modelling', 'laser tag', 'jigsaw puzzles', 'working on cars', 'keep a journal', 'diecast collectibles', 'mountainbiking', 'beachcombing', 'hang gliding', 'storm chasing', 'basejumping', 'scullingorrowing', 'weightlifting', 'movieandmoviememorabiliacollecting', 'butterfly watching', 'collecting sports cards (baseball, football, basketball, hockey)', 'tethercar', 'games', 'foraging', 'digital arts', 'sewing', 'vintage cars', 'camping', 'going to movies', 'impersonations', 'rock collecting', 'speed skating', 'paintball', 'coin collecting', 'boomerangs', 'watching television', 'leathercrafting', 'gymnastics', 'graphicdesign', 'ghosthunting', 'homebrewing', 'fast cars', 'r/c boats', 'kiteflying', 'bicycling', 'fantasysports', 'r/c cars', 'playingmusicalinstruments', 'whalewatching', 'handwriting analysis', 'netball', 'listeningtomusic', 'beadwork', 'sunbathing', 'insect collecting', 'roller derby', 'dodgeball', 'base jumping', 'car racing', 'acrobatics', 'beekeeping', 'nordic skating', 'video game collecting', 'parkour', 'model aircraft', 'fencing', 'model railroading', 'wrestling', 'computers', 'badminton', 'lego building', 'eating out', 'calligraphy', 'bell ringing', 'lace making', 'inline skating', 'brazilian jiu-jitsu', 'orienteering', 'robotics', 'bookrestoration', 'basketball', 'philately', 'satellitewatching', 'graphic design', 'dominoes', 'judo', 'macrame', 'meteorology', 'collecting music albums', 'bodybuilding', 'darts', 'video games', 'metaldetecting', 'coloring', 'go', 'auto audiophilia', 'urbanexploration', 'poker', 'microscopy', 'book restoration', 'jigsawpuzzles', 'marching band', 'animals/pets', 'stonecollecting', 'self improvement', 'beach/sun tanning', 'card collecting', 'yoyo', 'footbag', 'sun bathing', 'breakdancing', 'larping', 'skydiving', 'kabaddi', 'building dollhouses', 'boardsports', 'aquascaping', 'comicbookcollecting', 'writing music', 'vacation', 'tether car', 'literature', 'sleeping', 'survival skills', 'freestyle football', 'slotcarracing', 'backpacking', 'r/c helicopters', 'jukskei', 'flag football', 'canoeing', 'mushroom hunting', 'bird watching', 'shooting', 'autoracing', 'papermaking', 'hikingbackpacking', 'bookcollecting', 'ceramics', 'taichi', 'relaxing', 'baseball', 'quilling', 'highpowerrocketry', 'standupcomedy', 'water sports', 'lasertag', 'powerlifting', 'crochet', 'rockbalancing', 'sandart', 'mountain biking', 'volunteering', 'kombuchabrewing', 'high-power rocketry', 'mushroomhuntingmycology', 'cave diving', 'painting', 'novels', 'color guard', 'insectcollecting', 'mountaineering', 'self defense', 'lego', 'herp keeping', 'glassblowing', 'figureskating']


for line in sys.stdin:
    try:
        line = line

        # 0 load json
        try:
            js = json.loads(line)
        except:
            continue
        if not isinstance(js, dict):
            continue
        if 'author' not in js or 'subreddit' not in js or js['author'] == '[deleted]' or js['author'] == "":
            continue
        if 'selftext' not in js and 'body' not in js:
            continue
        if len((js.get('selftext', '') + js.get('body', '')).strip()) == 0:
            continue
        if 'subreddit' not in js and 'subreddit_id' not in js:
            continue
        if js['subreddit'] in black_list:
            continue
        if "\"" in js.get('selftext', '') or "\"" in js.get('body', ''):
            continue

        # 1 extract text
        txt = (js.get('selftext', '') + ' ' + js.get('body', '') + ' ' + js.get('title', '')) #
        original_txt = txt
        txt = txt.lower()

        pattern = re.compile('#[\w]*')
        txt = pattern.sub(' ', txt)
        pattern = re.compile('[\w]*@[\w]*')
        txt = pattern.sub(' ', txt)
        txt = re.sub(r'https?:\/\/.*[\r\n]*', '', txt)

        pattern = re.compile('([^\s\w\']|_)+|\d|\t|\n')
        txt = pattern.sub(' ', txt)
        pattern = re.compile('\s+')
        txt = pattern.sub(" ", txt)
        pattern = re.compile('\.+')
        txt = pattern.sub(".", txt)

        # 3 check post len
        post_len = len([x for x in txt.split(" ") if len(x.strip().strip(".")) > 1])
        if post_len > 100 or post_len < 10:
            continue

        # 4 check pattern
        line = txt
        found_patterns = [line.find(p[0]) + p[1] for p in patterns_with_len if p[0] in line]
        prof_name = "-1"
        if len(found_patterns) != 0:
            for pat in found_patterns:
                for hobby in hobbies_big:
                    cur_pos = line.find(" " + hobby + " ", pat - 2, pat + len(hobby) + 4)
                    if cur_pos != -1 and line.find(" no ", pat, cur_pos + 1) == -1 and line.find(" not ", pat, cur_pos + 1) == -1:
                        if prof_name == "-1":
                            prof_name = hobby
                        else:
                            prof_name += ":::" + hobby

        # 5 and finally
        print(u'%s\t%s___%s' % (js["author"], prof_name, js["id"]))
    except:
        continue
